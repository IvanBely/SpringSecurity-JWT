# Spring Security JWT

Это приложение использует Spring Security и JWT (JSON Web Token) для управления аутентификацией и авторизацией пользователей. Оно предоставляет возможности для регистрации, аутентификации пользователей, а также примеры использования различных уровней доступа.

## Основные компоненты

### Контроллеры

#### `AccountController`

Этот контроллер обрабатывает запросы, связанные с аутентификацией пользователей.

- **Регистрация пользователя** (`POST /auth/sign-up`): 
  Принимает запросы на регистрацию пользователей. Запросы валидируются на основе аннотаций `@NotBlank`, `@Size` и `@Email`, обеспечивая корректность имени пользователя, электронной почты и пароля. При успешной регистрации пользователю выдается JWT.

- **Авторизация пользователя** (`POST /auth/sign-in`):
  Обрабатывает запросы на аутентификацию пользователей. Запросы валидируются на основе аннотаций `@NotBlank` и `@Size`, проверяя корректность имени пользователя и пароля. При успешной аутентификации пользователю возвращается JWT.

#### `ExampleController`

Этот контроллер демонстрирует различные уровни доступа.

- **Пример доступа для всех авторизованных пользователей** (`GET /example`):
  Доступен только авторизованным пользователям. Возвращает строку "Hello, world!".

- **Пример доступа для администраторов** (`GET /example/admin`):
  Доступен только пользователям с ролью ADMIN. Возвращает строку "Hello, admin!".

- **Получение роли ADMIN (для демонстрации)** (`GET /example/get-admin`):
  Предназначен для демонстрации и позволяет текущему пользователю получить роль ADMIN.

### DTO

- **SignInRequest**:
  Запрос для аутентификации, содержащий имя пользователя и пароль. Валидируется на основе аннотаций `@NotBlank` и `@Size`.

- **SignUpRequest**:
  Запрос для регистрации, содержащий имя пользователя, адрес электронной почты и пароль. Валидируется на основе аннотаций `@NotBlank`, `@Size` и `@Email`.

### Модели

- **Role**:
  Перечисление ролей пользователей: `ROLE_USER` и `ROLE_ADMIN`.

- **User**:
  Сущность пользователя с полями: `id`, `username`, `password`, `email`, и `role`. Реализует интерфейс `UserDetails` для интеграции со Spring Security.

### Репозитории

- **UserRepository**:
  Репозиторий для сущности `User`, предоставляющий методы для поиска пользователей по имени и проверки уникальности имени и электронной почты.

### Конфигурация безопасности

- **SecurityConfig**:
  Конфигурация безопасности для настройки фильтрации запросов, авторизации и аутентификации. Использует JWT для безсессионной аутентификации и настроен для обработки различных уровней доступа.

- **JwtAuthenticationFilter**:
  Фильтр для проверки JWT в запросах и установки аутентификации в контексте безопасности.

- **JwtUtil**:
  Утилитный класс для генерации и проверки JWT. Использует секретный ключ для подписи токенов и проверки их подлинности.

### Сервисы

- **AuthenticationService**:
  Сервис для регистрации и аутентификации пользователей. Генерирует JWT для успешных операций.

- **UserDetailsServiceImpl**:
  Реализация `UserDetailsService` для загрузки пользователей по имени пользователя.

- **UserService**:
  Сервис для управления пользователями, включая создание, получение текущего пользователя и демонстрационное повышение прав до ADMIN.

## Запуск приложения

1. Убедитесь, что у вас установлен Java и Maven.
2. Склонируйте репозиторий: `git clone <url>`
3. Перейдите в директорию проекта: `cd <папка проекта>`
4. Соберите и запустите приложение: `mvn spring-boot:run`

## Примеры запросов

- Регистрация пользователя:
  ```bash
  curl -X POST http://localhost:8080/auth/sign-up \
       -H "Content-Type: application/json" \
       -d '{"username": "user", "email": "user@example.com", "password": "password"}'
